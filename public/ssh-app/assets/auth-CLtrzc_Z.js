import{R as e,r as t,j as s,u as r,a,L as n,z as i}from"./vendor-HEgq438T.js";import{o,s as l,t as c,e as d,n as m,l as u}from"./forms-eJNwyzrv.js";import{t as g,c as h}from"./utils-BpqZfnrR.js";function x(...e){return g(h(e))}function p(e,t="EUR"){return new Intl.NumberFormat("en-IE",{style:"currency",currency:t}).format(e)}function f(e,t){return`${e}-${t} years`}function y(e){const t={elementary:"bg-green-100 text-green-800",basic:"bg-blue-100 text-blue-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"};return t[e]||t.basic}const b=e.forwardRef(({className:r,variant:a="primary",size:n="md",loading:i=!1,disabled:o,children:l,...c},d)=>{const m=t.useRef(null);e.useEffect(()=>{d&&("function"==typeof d?d(m.current):d.current=m.current)},[d]);const u=c.onMouseDown,g=c.onKeyDown,h={primary:"rgba(255,165,0,0.28)",secondary:"rgba(59,130,246,0.20)",outline:"rgba(99,102,241,0.08)",ghost:"rgba(0,0,0,0.08)",danger:"rgba(239,68,68,0.22)"},p=(e,t)=>{const s=m.current;if(!s)return;const r=s.getBoundingClientRect(),n=.5*Math.max(r.width,r.height),i=document.createElement("span");i.style.position="absolute",i.style.borderRadius="50%",i.style.pointerEvents="none",i.style.width=i.style.height=`${n}px`,i.style.left=e-r.left-n/2+"px",i.style.top=t-r.top-n/2+"px";const o=h[a]||"rgba(255,255,255,0.28)";i.style.background=o,i.style.transform="scale(0)",i.style.opacity="1",i.style.transition="transform 350ms cubic-bezier(.22,.9,.31,1), opacity 350ms ease-out",i.style.zIndex="10",s.appendChild(i),requestAnimationFrame(()=>{i.style.transform="scale(3)",i.style.opacity="0"});const l=()=>{try{i.remove()}catch{}};i.addEventListener("transitionend",l),setTimeout(l,400)};return s.jsxs("button",{ref:m,onMouseDown:e=>{null==u||u(e),p(e.clientX,e.clientY)},onKeyDown:e=>{if(null==g||g(e),"Enter"===e.key||" "===e.key||"Spacebar"===e.key){const e=m.current;if(!e)return;const t=e.getBoundingClientRect(),s=t.left+t.width/2,r=t.top+t.height/2;p(s,r)}},className:x("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none relative overflow-hidden","hover:shadow-[0_20px_40px_rgba(255,165,0,0.18)] active:scale-[0.99] transition-transform",{primary:"bg-orange-600 text-white hover:bg-orange-700 focus:ring-orange-500",secondary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-orange-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-orange-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[a],{sm:"px-3 py-1.5 text-sm min-h-[40px]",md:"px-4 py-2 text-sm min-h-[44px]",lg:"px-6 py-3 text-base min-h-[48px]"}[n],r),disabled:o||i,...c,children:[i&&s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]})});b.displayName="Button";const w=new class{constructor(){this.state={user:null,loading:!0,initialized:!1},this.listeners=new Set}getState(){return{...this.state}}setState(e){this.state={...this.state,...e},this.notifyListeners()}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){this.listeners.forEach(e=>e())}setUser(e){this.setState({user:e})}setLoading(e){this.setState({loading:e})}setInitialized(e){this.setState({initialized:e})}clearAuth(){this.setState({user:null,loading:!1})}};function j(){return Math.random().toString(36).substr(2,9)+Date.now().toString(36)}function v(){const e=(new Date).getFullYear(),t=S().filter(t=>{var s;return null==(s=t.student_id)?void 0:s.startsWith(`EYG-${e}-`)}).length+1;return`EYG-${e}-${t.toString().padStart(4,"0")}`}const N={USERS:"eyogi_users",CURRENT_SESSION:"eyogi_session"};function S(){const e=localStorage.getItem(N.USERS);return e?JSON.parse(e):[]}function _(e){return S().find(t=>t.email===e)||null}function E(e){const t={user:e,access_token:j(),expires_at:Date.now()+864e5};return localStorage.setItem(N.CURRENT_SESSION,JSON.stringify(t)),t}async function P(e,t,s){await new Promise(e=>setTimeout(e,500));if(_(e))throw new Error("User already exists with this email");const r={id:j(),email:e,full_name:s.full_name||"",avatar_url:s.avatar_url||void 0,role:s.role||"student",age:s.age,phone:s.phone,address:s.address,parent_guardian_name:s.parent_guardian_name,parent_guardian_email:s.parent_guardian_email,parent_guardian_phone:s.parent_guardian_phone,student_id:"student"===s.role?v():void 0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};!function(e){const t=S(),s=t.findIndex(t=>t.id===e.id);s>=0?t[s]={...e,updated_at:(new Date).toISOString()}:t.push(e),localStorage.setItem(N.USERS,JSON.stringify(t))}(r);const a=E(r);return w.setUser(r),{user:r,session:a}}async function C(){await new Promise(e=>setTimeout(e,200)),localStorage.removeItem(N.CURRENT_SESSION),w.clearAuth()}function I(){const[e,s]=t.useState(w.getState());t.useEffect(()=>{const t=w.subscribe(()=>{s(w.getState())});return e.initialized||r(),t},[e.initialized]);const r=async()=>{try{w.setLoading(!0);const e=function(){const e=localStorage.getItem(N.CURRENT_SESSION);if(!e)return null;const t=JSON.parse(e);return Date.now()>t.expires_at?(localStorage.removeItem(N.CURRENT_SESSION),null):t}();(null==e?void 0:e.user)?w.setUser(e.user):w.setUser(null)}catch(e){w.setUser(null)}finally{w.setLoading(!1),w.setInitialized(!0)}};return{user:e.user,loading:e.loading,initialized:e.initialized,signOut:async()=>{try{w.setLoading(!0),await C(),w.clearAuth(),window.location.href="/"}catch(e){}finally{w.setLoading(!1)}},refreshUser:async()=>{await r()},updateUser:e=>{w.setUser(e)}}}const R=t.createContext(void 0);function U(){const e=t.useContext(R);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}function k({children:e}){const r=I();return t.useEffect(()=>{const e=e=>{"eyogi_session"===e.key&&r.refreshUser()};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[r]),s.jsx(R.Provider,{value:r,children:e})}function A({className:e,children:t}){return s.jsxs("div",{className:x("relative overflow-hidden rounded-lg","bg-gradient-to-br from-white/30 via-white/10 to-white/5 border border-white/20 backdrop-blur-md","shadow-[0_8px_30px_rgba(16,24,40,0.08)]",e),children:[s.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0",children:s.jsx("div",{className:"card-sheen"})}),t]})}function O({className:e,children:t}){return s.jsx("div",{className:x("px-6 py-4 border-b border-gray-200",e),children:t})}function z({className:e,children:t}){return s.jsx("div",{className:x("px-6 py-4",e),children:t})}const T=e.forwardRef(({className:e,label:t,error:r,helperText:a,id:n,...i},o)=>{const l=n||(null==t?void 0:t.toLowerCase().replace(/\s+/g,"-"));return s.jsxs("div",{className:"space-y-1",children:[t&&s.jsx("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700",children:t}),s.jsx("input",{ref:o,id:l,className:x("block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-1000 focus:ring-orange-1000 text-base px-4 py-3",r&&"border-red-300 focus:border-red-500 focus:ring-red-500",e),...i}),r&&s.jsx("p",{className:"text-sm text-red-600",children:r}),a&&!r&&s.jsx("p",{className:"text-sm text-gray-500",children:a})]})});async function L(e,t){return await async function(e,t){await new Promise(e=>setTimeout(e,500));const s=_(e);if(!s)throw new Error("Invalid email or password");if("123456"!==t)throw new Error("Invalid email or password");const r=E(s);return w.setUser(s),{user:s,session:r}}(e,t)}T.displayName="Input";const D=o({email:l().email("Please enter a valid email address"),password:l().min(6,"Password must be at least 6 characters")});function F(){var e,o;const[l,d]=t.useState(!1),m=r(),{refreshUser:u}=U(),{register:g,handleSubmit:h,formState:{errors:x}}=a({resolver:c(D)});return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 page-with-header",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"eY"})})}),s.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Sign in to your account"}),s.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Or"," ",s.jsx(n,{to:"/auth/signup",className:"font-medium text-orange-600 hover:text-orange-500",children:"create a new account"})]})]}),s.jsxs(A,{children:[s.jsx(O,{children:s.jsx("h3",{className:"text-lg font-medium",children:"Welcome back"})}),s.jsx(z,{children:s.jsxs("form",{onSubmit:h(async e=>{d(!0);try{await L(e.email,e.password),await u(),i.success("Welcome back!"),m("/dashboard")}catch(t){t instanceof Error?i.error(t.message):i.error("Failed to sign in")}finally{d(!1)}}),className:"space-y-6",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Test Login Credentials"}),s.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Student:"})," student@test.com (password: 123456)"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Teacher:"})," teacher@test.com (password: 123456)"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Admin:"})," admin@test.com (password: 123456)"]})]})]}),s.jsx(T,{label:"Email address",type:"email",autoComplete:"email",...g("email"),error:null==(e=x.email)?void 0:e.message}),s.jsx(T,{label:"Password",type:"password",autoComplete:"current-password",...g("password"),error:null==(o=x.password)?void 0:o.message}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),s.jsx("div",{className:"text-sm",children:s.jsx(n,{to:"/auth/forgot-password",className:"font-medium text-orange-600 hover:text-orange-500",children:"Forgot your password?"})})]}),s.jsx(b,{type:"submit",className:"w-full",loading:l,children:"Sign in"})]})})]}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Need help?"," ",s.jsx(n,{to:"/contact",className:"font-medium text-orange-600 hover:text-orange-500",children:"Contact support"})]})})]})})}const G=o({email:l().email("Please enter a valid email address"),password:l().min(6,"Password must be at least 6 characters"),confirmPassword:l(),full_name:l().min(2,"Full name must be at least 2 characters"),age:m().min(4,"Age must be at least 4").max(100,"Age must be less than 100"),role:d(["student","teacher"]),phone:l().optional(),parent_guardian_name:l().optional(),parent_guardian_email:l().email().optional().or(u("")),parent_guardian_phone:l().optional()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}).refine(e=>!(e.age<18&&"student"===e.role)||e.parent_guardian_name&&e.parent_guardian_email,{message:"Parent/Guardian information is required for students under 18",path:["parent_guardian_name"]});function Y(){var e,o,l,d,m,u,g,h,x;const[p,f]=t.useState(!1),y=r(),{refreshUser:w}=U(),{register:j,handleSubmit:v,watch:N,formState:{errors:S}}=a({resolver:c(G),defaultValues:{role:"student"}}),_=N("age"),E=N("role");return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 page-with-header",children:s.jsxs("div",{className:"max-w-2xl w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"eY"})})}),s.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create your account"}),s.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Or"," ",s.jsx(n,{to:"/auth/signin",className:"font-medium text-orange-600 hover:text-orange-500",children:"sign in to your existing account"})]})]}),s.jsxs(A,{children:[s.jsx(O,{children:s.jsx("h3",{className:"text-lg font-medium",children:"Join eYogi Gurukul"})}),s.jsx(z,{children:s.jsxs("form",{onSubmit:v(async e=>{f(!0);try{const{confirmPassword:t,...s}=e;await async function(e,t,s){return await P(e,0,s)}(e.email,e.password,s),await w(),i.success("Account created successfully! Please check your email to verify your account."),y("/auth/signin")}catch(t){t instanceof Error?i.error(t.message):i.error("Failed to create account")}finally{f(!1)}}),className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(T,{label:"Full Name",...j("full_name"),error:null==(e=S.full_name)?void 0:e.message}),s.jsx(T,{label:"Email Address",type:"email",autoComplete:"email",...j("email"),error:null==(o=S.email)?void 0:o.message}),s.jsx(T,{label:"Age",type:"number",...j("age",{valueAsNumber:!0}),error:null==(l=S.age)?void 0:l.message}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),s.jsxs("select",{...j("role"),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-500 focus:ring-orange-500 text-base px-4 py-3",children:[s.jsx("option",{value:"student",children:"Student"}),s.jsx("option",{value:"teacher",children:"Teacher"})]}),S.role&&s.jsx("p",{className:"text-sm text-red-600",children:S.role.message})]}),s.jsx(T,{label:"Phone Number (Optional)",type:"tel",...j("phone"),error:null==(d=S.phone)?void 0:d.message})]}),_<18&&"student"===E&&s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Parent/Guardian Information (Required for students under 18)"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(T,{label:"Parent/Guardian Name",...j("parent_guardian_name"),error:null==(m=S.parent_guardian_name)?void 0:m.message}),s.jsx(T,{label:"Parent/Guardian Email",type:"email",...j("parent_guardian_email"),error:null==(u=S.parent_guardian_email)?void 0:u.message}),s.jsx(T,{label:"Parent/Guardian Phone",type:"tel",...j("parent_guardian_phone"),error:null==(g=S.parent_guardian_phone)?void 0:g.message})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(T,{label:"Password",type:"password",autoComplete:"new-password",...j("password"),error:null==(h=S.password)?void 0:h.message}),s.jsx(T,{label:"Confirm Password",type:"password",autoComplete:"new-password",...j("confirmPassword"),error:null==(x=S.confirmPassword)?void 0:x.message})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:"agree-terms",name:"agree-terms",type:"checkbox",required:!0,className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"}),s.jsxs("label",{htmlFor:"agree-terms",className:"ml-2 block text-sm text-gray-900",children:["I agree to the"," ",s.jsx(n,{to:"/terms",className:"text-orange-600 hover:text-orange-500",children:"Terms of Service"})," ","and"," ",s.jsx(n,{to:"/privacy",className:"text-orange-600 hover:text-orange-500",children:"Privacy Policy"})]})]}),s.jsx(b,{type:"submit",className:"w-full",loading:p,children:"Create Account"})]})})]}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Need help?"," ",s.jsx(n,{to:"/contact",className:"font-medium text-orange-600 hover:text-orange-500",children:"Contact support"})]})})]})})}export{k as A,b as B,A as C,T as I,F as S,z as a,O as b,x as c,f as d,Y as e,p as f,y as g,U as u};
